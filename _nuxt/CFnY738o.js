import{D as p,g as O}from"./yVQJMz2a.js";const E=p("scrollStore",()=>{const o=O([]),g=(e,t,n)=>{o.length&&e in o.map(r=>r.key)||(o.push({key:e,target:n??window,isTargetCustom:!!n,callNextContentsPending:!1,isOutOfContent:!1,lastScroll:0,isBarExist:!1,callNextContents:t}),setTimeout(()=>{var c;const r=(c=s(e))==null?void 0:c.target;r&&r.addEventListener("scroll",()=>l(e)),setTimeout(()=>{x(e)},100)},1))},d=e=>{var r;const t=(r=s(e))==null?void 0:r.target;t&&t.removeEventListener("scroll",()=>l(e));const n=i(e);n<0||o.splice(n,1)},s=e=>{if(!o.length)return;const t=o.filter(n=>n.key===e);if(t.length)return t.pop()},i=e=>o.findIndex(t=>t.key===e),C=e=>{const t=s(e);if(!t)return;let n=document.documentElement.scrollTop||document.body.scrollTop;n>0&&t.lastScroll<=n,t.lastScroll=n},l=async e=>{const t=s(e);if(!t)return;C(e);let n=!1;if(t.isTargetCustom){const r=t.target.scrollHeight-t.target.scrollTop,u=t.target.offsetHeight-r;n=u>-1&&u!==0}else n=window.innerHeight+window.scrollY+1>=document.body.offsetHeight;n&&(t.callNextContentsPending||t.isOutOfContent||await a(e))},a=async e=>{const t=s(e);if(!t)return;t.callNextContentsPending=!0;const n=await t.callNextContents();f(e,n),t.callNextContentsPending=!1},x=e=>{const t=s(e);t&&(t.callNextContentsPending||(t.isTargetCustom?t.isBarExist=window.innerHeight!==document.body.clientHeight:t.isBarExist=t.target.clientHeight!==document.body.clientHeight))},f=(e,t)=>{const n=i(e);n<0||(o[n].isOutOfContent=t)};return{register:g,onBeforeUnmount:d,detectScrollEnd:l,setIsOutOfContent:f,callNextContents:a,showClick2GetNext:e=>{const t=s(e);t&&setTimeout(()=>!t.isBarExist&&!t.callNextContentsPending&&!t.isOutOfContent,100)},getIsOutOfContent:e=>{const t=s(e);if(t)return t.isOutOfContent},getCallNextContentsPending:e=>{const t=s(e);if(t)return t.callNextContentsPending},setScroll2Top:()=>{window.scrollTo(0,0)},init:e=>{const t=i(e);t<0||(o[t].callNextContentsPending=!1,o[t].isOutOfContent=!1,o[t].lastScroll=0,o[t].isBarExist=!1)}}});export{E as u};
